<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: User</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">User</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/models/user_rb.html">
                app/models/user.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                ActiveRecord::Base
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000153">active?</a>&nbsp;&nbsp;
      <a href="#M000151">add_contact</a>&nbsp;&nbsp;
      <a href="#M000133">adjusted_time</a>&nbsp;&nbsp;
      <a href="#M000132">assets_formated_size</a>&nbsp;&nbsp;
      <a href="#M000131">assets_size</a>&nbsp;&nbsp;
      <a href="#M000155">authenticate</a>&nbsp;&nbsp;
      <a href="#M000158">authenticated?</a>&nbsp;&nbsp;
      <a href="#M000150">authorized?</a>&nbsp;&nbsp;
      <a href="#M000147">avatar_url</a>&nbsp;&nbsp;
      <a href="#M000163">before_create</a>&nbsp;&nbsp;
      <a href="#M000137">board_invitation</a>&nbsp;&nbsp;
      <a href="#M000145">board_modified</a>&nbsp;&nbsp;
      <a href="#M000146">board_visited</a>&nbsp;&nbsp;
      <a href="#M000141">display_name</a>&nbsp;&nbsp;
      <a href="#M000157">encrypt</a>&nbsp;&nbsp;
      <a href="#M000156">encrypt</a>&nbsp;&nbsp;
      <a href="#M000165">encrypt_password</a>&nbsp;&nbsp;
      <a href="#M000140">first_login?</a>&nbsp;&nbsp;
      <a href="#M000161">forget_me</a>&nbsp;&nbsp;
      <a href="#M000142">full_name</a>&nbsp;&nbsp;
      <a href="#M000136">get</a>&nbsp;&nbsp;
      <a href="#M000149">in_role?</a>&nbsp;&nbsp;
      <a href="#M000138">is_invited_to_board?</a>&nbsp;&nbsp;
      <a href="#M000139">is_user_of_board?</a>&nbsp;&nbsp;
      <a href="#M000154">is_visible?</a>&nbsp;&nbsp;
      <a href="#M000135">last_login_date</a>&nbsp;&nbsp;
      <a href="#M000167">login_required?</a>&nbsp;&nbsp;
      <a href="#M000143">nick_name</a>&nbsp;&nbsp;
      <a href="#M000166">password_required?</a>&nbsp;&nbsp;
      <a href="#M000160">remember_me</a>&nbsp;&nbsp;
      <a href="#M000159">remember_token?</a>&nbsp;&nbsp;
      <a href="#M000134">reset_time</a>&nbsp;&nbsp;
      <a href="#M000164">set_email</a>&nbsp;&nbsp;
      <a href="#M000148">sha1_no_salt</a>&nbsp;&nbsp;
      <a href="#M000144">short_name</a>&nbsp;&nbsp;
      <a href="#M000152">status_name</a>&nbsp;&nbsp;
      <a href="#M000162">validate</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">password_required</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Virtual attribute for the unencrypted password, etc

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">pwd</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Virtual attribute for the unencrypted password, etc

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">terms_of_service</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Virtual attribute for the unencrypted password, etc

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000155" class="method-detail">
        <a name="M000155"></a>

        <div class="method-heading">
          <a href="#M000155" class="method-signature">
          <span class="method-name">authenticate</span><span class="method-args">(login, password)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Authenticates a user by their login name and unencrypted password. Returns
the user or nil.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000155-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000155-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 220</span>
220:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authenticate</span>(<span class="ruby-identifier">login</span>, <span class="ruby-identifier">password</span>)
221:     <span class="ruby-identifier">u</span> = <span class="ruby-identifier">find_by_login_and_status</span>(<span class="ruby-identifier">login</span>,<span class="ruby-constant">Status</span><span class="ruby-operator">::</span><span class="ruby-constant">ACTIVE</span>) <span class="ruby-comment cmt"># need to get the salt</span>
222:     <span class="ruby-identifier">u</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">u</span>.<span class="ruby-identifier">authenticated?</span>(<span class="ruby-identifier">password</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">u</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
223:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000156" class="method-detail">
        <a name="M000156"></a>

        <div class="method-heading">
          <a href="#M000156" class="method-signature">
          <span class="method-name">encrypt</span><span class="method-args">(password, salt)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Encrypts some data with the salt.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000156-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000156-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 226</span>
226:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encrypt</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>)
227:     <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-node">&quot;#{salt}--#{password}--&quot;</span>)
228:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000136" class="method-detail">
        <a name="M000136"></a>

        <div class="method-heading">
          <a href="#M000136" class="method-signature">
          <span class="method-name">get</span><span class="method-args">(id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000136-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000136-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 84</span>
84:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">get</span> <span class="ruby-identifier">id</span>
85:     <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">id</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">1</span>)
86:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000148" class="method-detail">
        <a name="M000148"></a>

        <div class="method-heading">
          <a href="#M000148" class="method-signature">
          <span class="method-name">sha1_no_salt</span><span class="method-args">(pass)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
With no salt to generate tokens
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000148-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000148-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 159</span>
159:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">sha1_no_salt</span>(<span class="ruby-identifier">pass</span>)
160:     <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-identifier">pass</span>)
161:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000153" class="method-detail">
        <a name="M000153"></a>

        <div class="method-heading">
          <a href="#M000153" class="method-signature">
          <span class="method-name">active?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
returns true if this record is active
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000153-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000153-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 197</span>
197:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active?</span>
198:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Status</span><span class="ruby-operator">::</span><span class="ruby-constant">ACTIVE</span>
199:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000151" class="method-detail">
        <a name="M000151"></a>

        <div class="method-heading">
          <a href="#M000151" class="method-signature">
          <span class="method-name">add_contact</span><span class="method-args">(another_user)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add another user as a contact to this user
</p>
<pre>
  and vice versa (another user gets this user as acontact too)
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000151-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000151-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_contact</span> <span class="ruby-identifier">another_user</span>
180:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contacts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">another_user</span>)
181:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">contacts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">another_user</span>
182:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">save</span>
183:     <span class="ruby-keyword kw">end</span>
184:     <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">another_user</span>.<span class="ruby-identifier">contacts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-keyword kw">self</span>)
185:       <span class="ruby-identifier">another_user</span>.<span class="ruby-identifier">contacts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>
186:       <span class="ruby-identifier">another_user</span>.<span class="ruby-identifier">save</span>
187:     <span class="ruby-keyword kw">end</span>
188:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000133" class="method-detail">
        <a name="M000133"></a>

        <div class="method-heading">
          <a href="#M000133" class="method-signature">
          <span class="method-name">adjusted_time</span><span class="method-args">(time=Time.now, daylight_saving=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000133-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000133-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 71</span>
71:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">adjusted_time</span>(<span class="ruby-identifier">time</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>, <span class="ruby-identifier">daylight_saving</span>=<span class="ruby-keyword kw">true</span>)
72:     <span class="ruby-identifier">time</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">read_attribute</span>(<span class="ruby-identifier">:time_offset</span>) <span class="ruby-operator">+</span> (<span class="ruby-identifier">daylight_saving</span> <span class="ruby-value">? </span>(<span class="ruby-identifier">read_attribute</span>(<span class="ruby-identifier">:daylight_savings</span>)<span class="ruby-operator">*</span><span class="ruby-value">3600</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
73:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000132" class="method-detail">
        <a name="M000132"></a>

        <div class="method-heading">
          <a href="#M000132" class="method-signature">
          <span class="method-name">assets_formated_size</span><span class="method-args">(s=&quot;auto&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000132-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000132-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 55</span>
55:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assets_formated_size</span> <span class="ruby-identifier">s</span>=<span class="ruby-value str">&quot;auto&quot;</span>
56:     <span class="ruby-identifier">bytes</span> = <span class="ruby-identifier">assets_size</span>
57:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;auto&quot;</span>
58:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">bytes</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1073741823</span>
59:         <span class="ruby-identifier">s</span>,<span class="ruby-identifier">a</span> = <span class="ruby-value str">&quot;gigabytes&quot;</span>,<span class="ruby-value str">&quot;GB&quot;</span>
60:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">bytes</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1048575</span> 
61:         <span class="ruby-identifier">s</span>,<span class="ruby-identifier">a</span> = <span class="ruby-value str">&quot;megabytes&quot;</span>,<span class="ruby-value str">&quot;MB&quot;</span>
62:       <span class="ruby-keyword kw">else</span>
63:         <span class="ruby-identifier">s</span>,<span class="ruby-identifier">a</span> = <span class="ruby-value str">&quot;kilobytes&quot;</span>,<span class="ruby-value str">&quot;kB&quot;</span>
64:       <span class="ruby-keyword kw">end</span>
65:     <span class="ruby-keyword kw">end</span>
66:     <span class="ruby-identifier">v</span> = <span class="ruby-identifier">bytes</span> <span class="ruby-operator">/</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">s</span>.<span class="ruby-identifier">to_s</span>)
67:     <span class="ruby-identifier">total_size</span> = <span class="ruby-constant">HashWithIndifferentAccess</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:value</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">s</span>.<span class="ruby-identifier">to_s</span><span class="ruby-operator">==</span><span class="ruby-value str">&quot;kilobytes&quot;</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">v</span><span class="ruby-operator">*</span><span class="ruby-value">100</span>).<span class="ruby-identifier">to_i</span>.<span class="ruby-identifier">to_f</span><span class="ruby-operator">/</span><span class="ruby-value">100</span>),<span class="ruby-identifier">:abr</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">a</span>)
68:                 <span class="ruby-node">&quot;#{total_size[:value]} #{total_size[:abr]}&quot;</span>
69:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000131" class="method-detail">
        <a name="M000131"></a>

        <div class="method-heading">
          <a href="#M000131" class="method-signature">
          <span class="method-name">assets_size</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <hr size="10"></hr><p>
Public Methods
</p>
<hr size="10"></hr>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000131-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000131-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 51</span>
51:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">assets_size</span>
52:     <span class="ruby-identifier">assets</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">size</span> }.<span class="ruby-identifier">sum</span>
53:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000158" class="method-detail">
        <a name="M000158"></a>

        <div class="method-heading">
          <a href="#M000158" class="method-signature">
          <span class="method-name">authenticated?</span><span class="method-args">(password)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000158-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000158-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 235</span>
235:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authenticated?</span>(<span class="ruby-identifier">password</span>)
236:     <span class="ruby-identifier">crypted_password</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">encrypt</span>(<span class="ruby-identifier">password</span>)
237:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000150" class="method-detail">
        <a name="M000150"></a>

        <div class="method-heading">
          <a href="#M000150" class="method-signature">
          <span class="method-name">authorized?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000150-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000150-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 171</span>
171:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authorized?</span>
172:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">in_role?</span>(<span class="ruby-constant">Role</span><span class="ruby-operator">::</span><span class="ruby-constant">ADMIN</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">in_role?</span>(<span class="ruby-constant">Role</span><span class="ruby-operator">::</span><span class="ruby-constant">USER</span>) 
173:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
174:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000147" class="method-detail">
        <a name="M000147"></a>

        <div class="method-heading">
          <a href="#M000147" class="method-signature">
          <span class="method-name">avatar_url</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000147-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000147-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">avatar_url</span>
151:     <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">personal_image</span>.<span class="ruby-identifier">nil?</span>
152:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">personal_image</span>.<span class="ruby-identifier">public_uri</span>
153:     <span class="ruby-keyword kw">else</span> 
154:       <span class="ruby-value str">&quot;/images/user_icons/icon_placeholder_user_&quot;</span><span class="ruby-operator">+</span> <span class="ruby-node">&quot;#{((self.id ? self.id : rand(9))).to_s.last.to_i+1}&quot;</span> <span class="ruby-operator">+</span><span class="ruby-value str">&quot;.jpg&quot;</span>
155:     <span class="ruby-keyword kw">end</span>
156:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000137" class="method-detail">
        <a name="M000137"></a>

        <div class="method-heading">
          <a href="#M000137" class="method-signature">
          <span class="method-name">board_invitation</span><span class="method-args">(board)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000137-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000137-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 88</span>
88:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">board_invitation</span> <span class="ruby-identifier">board</span>
89:     <span class="ruby-identifier">pending_invitations</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">board</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">board</span>}.<span class="ruby-identifier">first</span>
90:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000145" class="method-detail">
        <a name="M000145"></a>

        <div class="method-heading">
          <a href="#M000145" class="method-signature">
          <span class="method-name">board_modified</span><span class="method-args">(board)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000145-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000145-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 140</span>
140:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">board_modified</span> <span class="ruby-identifier">board</span>
141:     <span class="ruby-identifier">bu</span> = <span class="ruby-identifier">boardusers</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;board_id = ? and user_id = ?&quot;</span>, <span class="ruby-identifier">board</span>.<span class="ruby-identifier">id</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span>])
142:     <span class="ruby-identifier">bu</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">:visited_on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">bu</span>
143:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000146" class="method-detail">
        <a name="M000146"></a>

        <div class="method-heading">
          <a href="#M000146" class="method-signature">
          <span class="method-name">board_visited</span><span class="method-args">(board)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000146-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000146-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 145</span>
145:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">board_visited</span> <span class="ruby-identifier">board</span>
146:     <span class="ruby-identifier">bu</span> = <span class="ruby-identifier">boardusers</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:first</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;board_id = ? and user_id = ?&quot;</span>, <span class="ruby-identifier">board</span>.<span class="ruby-identifier">id</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">id</span>])
147:     <span class="ruby-identifier">bu</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">:visited_on</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">bu</span>
148:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000141" class="method-detail">
        <a name="M000141"></a>

        <div class="method-heading">
          <a href="#M000141" class="method-signature">
          <span class="method-name">display_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
helper Gets the display name if it exist or email address otherwise
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000141-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000141-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 107</span>
107:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">display_name</span>
108:     <span class="ruby-identifier">f_name</span> = <span class="ruby-identifier">first_name</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">first_name</span>.<span class="ruby-identifier">empty?</span>
109:     <span class="ruby-identifier">l_name</span> = <span class="ruby-identifier">last_name</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">last_name</span>.<span class="ruby-identifier">empty?</span>
110:     (<span class="ruby-identifier">f_name</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">l_name!</span>=<span class="ruby-keyword kw">nil</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">f_name</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">l_name</span>) <span class="ruby-operator">:</span> (<span class="ruby-identifier">f_name</span> <span class="ruby-value">? </span><span class="ruby-identifier">f_name</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">l_name</span> <span class="ruby-value">? </span><span class="ruby-identifier">l_name</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">login</span>)))
111:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000157" class="method-detail">
        <a name="M000157"></a>

        <div class="method-heading">
          <a href="#M000157" class="method-signature">
          <span class="method-name">encrypt</span><span class="method-args">(password)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Encrypts the password with the user salt
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000157-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000157-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 231</span>
231:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encrypt</span>(<span class="ruby-identifier">password</span>)
232:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">encrypt</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>)
233:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000140" class="method-detail">
        <a name="M000140"></a>

        <div class="method-heading">
          <a href="#M000140" class="method-signature">
          <span class="method-name">first_login?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Checks to see if it&#8216;s a new user
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000140-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000140-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 101</span>
101:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">first_login?</span>
102:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">created_on</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">updated_on</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>
103:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000161" class="method-detail">
        <a name="M000161"></a>

        <div class="method-heading">
          <a href="#M000161" class="method-signature">
          <span class="method-name">forget_me</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000161-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000161-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 250</span>
250:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">forget_me</span>
251:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">remember_token_expires_at</span> = <span class="ruby-keyword kw">nil</span>
252:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">remember_token</span>            = <span class="ruby-keyword kw">nil</span>
253:     <span class="ruby-identifier">save</span>(<span class="ruby-keyword kw">false</span>)
254:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000142" class="method-detail">
        <a name="M000142"></a>

        <div class="method-heading">
          <a href="#M000142" class="method-signature">
          <span class="method-name">full_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
helper Gets the full name if it exist
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000142-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000142-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 115</span>
115:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">full_name</span>
116:     <span class="ruby-identifier">name</span> = [<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">first_name</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">last_name</span>].<span class="ruby-identifier">compact</span>
117:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">empty?</span>
118:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000149" class="method-detail">
        <a name="M000149"></a>

        <div class="method-heading">
          <a href="#M000149" class="method-signature">
          <span class="method-name">in_role?</span><span class="method-args">(role_id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <hr size="10"></hr><p>
<a href="User.html">User</a> authentication
</p>
<hr size="10"></hr>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000149-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000149-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 167</span>
167:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">in_role?</span> <span class="ruby-identifier">role_id</span>
168:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">roles</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">element</span><span class="ruby-operator">|</span> <span class="ruby-identifier">element</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">role_id</span>}.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
169:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000138" class="method-detail">
        <a name="M000138"></a>

        <div class="method-heading">
          <a href="#M000138" class="method-signature">
          <span class="method-name">is_invited_to_board?</span><span class="method-args">(board)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000138-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000138-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 92</span>
92:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_invited_to_board?</span> <span class="ruby-identifier">board</span>
93:     <span class="ruby-identifier">pending_invitations</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">board</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">board</span>}.<span class="ruby-identifier">first</span>
94:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000139" class="method-detail">
        <a name="M000139"></a>

        <div class="method-heading">
          <a href="#M000139" class="method-signature">
          <span class="method-name">is_user_of_board?</span><span class="method-args">(board)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000139-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000139-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 96</span>
96:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_user_of_board?</span> <span class="ruby-identifier">board</span>
97:     <span class="ruby-identifier">boards</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">board</span>
98:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000154" class="method-detail">
        <a name="M000154"></a>

        <div class="method-heading">
          <a href="#M000154" class="method-signature">
          <span class="method-name">is_visible?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns visibility flag of user based on visibility of its role. The method
is used to determine if to display the user in various UI components such
as shared board user lis not visible generally means anonymous user which
is internal housekkeping user for public boards
</p>
<p>
the logic is such :
</p>
<pre>
 - true if at least one role is visible
 - false otherwise
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000154-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000154-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 208</span>
208:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_visible?</span>
209:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">roles</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">role</span> <span class="ruby-operator">|</span>
210:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">role</span>.<span class="ruby-identifier">is_visible?</span>
211:     <span class="ruby-keyword kw">end</span>
212:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
213:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000135" class="method-detail">
        <a name="M000135"></a>

        <div class="method-heading">
          <a href="#M000135" class="method-signature">
          <span class="method-name">last_login_date</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000135-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000135-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 79</span>
79:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">last_login_date</span>
80:     <span class="ruby-identifier">date</span> = <span class="ruby-identifier">read_attribute</span>(<span class="ruby-identifier">:last_login_date</span>)
81:     (<span class="ruby-identifier">date</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-value str">&quot;January 01, 2000&quot;</span>)) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">date</span>
82:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000143" class="method-detail">
        <a name="M000143"></a>

        <div class="method-heading">
          <a href="#M000143" class="method-signature">
          <span class="method-name">nick_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
helper Gets the full first name if it exist, otherwise the display name
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000143-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000143-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 122</span>
122:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nick_name</span>
123:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">first_name</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">first_name</span>.<span class="ruby-identifier">empty?</span>
124:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">display_name</span>
125:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000160" class="method-detail">
        <a name="M000160"></a>

        <div class="method-heading">
          <a href="#M000160" class="method-signature">
          <span class="method-name">remember_me</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
These create and unset the fields required for remembering users between
browser closes
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000160-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000160-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 244</span>
244:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remember_me</span>
245:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">remember_token_expires_at</span> = <span class="ruby-value">5</span>.<span class="ruby-identifier">weeks</span>.<span class="ruby-identifier">from_now</span>.<span class="ruby-identifier">utc</span>
246:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">remember_token</span>            = <span class="ruby-identifier">encrypt</span>(<span class="ruby-node">&quot;#{email}--#{remember_token_expires_at}&quot;</span>)
247:     <span class="ruby-identifier">save</span>(<span class="ruby-keyword kw">false</span>)
248:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000159" class="method-detail">
        <a name="M000159"></a>

        <div class="method-heading">
          <a href="#M000159" class="method-signature">
          <span class="method-name">remember_token?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000159-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000159-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 239</span>
239:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remember_token?</span>
240:     <span class="ruby-identifier">remember_token_expires_at</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">utc</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">remember_token_expires_at</span> 
241:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000134" class="method-detail">
        <a name="M000134"></a>

        <div class="method-heading">
          <a href="#M000134" class="method-signature">
          <span class="method-name">reset_time</span><span class="method-args">(time=Time.now, daylight_saving=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000134-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000134-source">
<pre>
    <span class="ruby-comment cmt"># File app/models/user.rb, line 75</span>
75:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset_time</span>(<span class="ruby-identifier">time</span>=<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>, <span class="ruby-identifier">daylight_saving</span>=<span class="ruby-keyword kw">true</span>)
76:     <span class="ruby-identifier">time</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">read_attribute</span>(<span class="ruby-identifier">:time_offset</span>) <span class="ruby-operator">-</span> (<span class="ruby-identifier">daylight_saving</span> <span class="ruby-value">? </span>(<span class="ruby-identifier">read_attribute</span>(<span class="ruby-identifier">:daylight_savings</span>)<span class="ruby-operator">*</span><span class="ruby-value">3600</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
77:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000144" class="method-detail">
        <a name="M000144"></a>

        <div class="method-heading">
          <a href="#M000144" class="method-signature">
          <span class="method-name">short_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
helper Trims display names to Initial and full Last Name. I.E &quot;J
Hoglund&quot; Trims email to name without @ and domain name
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000144-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000144-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 130</span>
130:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">short_name</span>
131:     <span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">display_name</span>
132:     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">&quot;@&quot;</span>
133:       <span class="ruby-identifier">name_split</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">split</span>
134:       <span class="ruby-keyword kw">return</span> (<span class="ruby-identifier">name_split</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">name_split</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-value">0</span>,<span class="ruby-value">1</span>) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot; &quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;&quot;</span> ) <span class="ruby-operator">+</span> <span class="ruby-identifier">name_split</span>.<span class="ruby-identifier">last</span> 
135:     <span class="ruby-keyword kw">else</span>
136:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'@'</span>).<span class="ruby-identifier">first</span>
137:     <span class="ruby-keyword kw">end</span>
138:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000152" class="method-detail">
        <a name="M000152"></a>

        <div class="method-heading">
          <a href="#M000152" class="method-signature">
          <span class="method-name">status_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
gets human readable status of this record ( disabled or active)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000152-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000152-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 192</span>
192:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">status_name</span>
193:     <span class="ruby-constant">Status</span><span class="ruby-operator">::</span><span class="ruby-constant">STATUS_NAMES</span>[<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">status</span>]
194:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000163" class="method-detail">
        <a name="M000163"></a>

        <div class="method-heading">
          <a href="#M000163" class="method-signature">
          <span class="method-name">before_create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
before filter
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000163-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000163-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 271</span>
271:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">before_create</span>
272:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">last_login_date</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>)
273:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000165" class="method-detail">
        <a name="M000165"></a>

        <div class="method-heading">
          <a href="#M000165" class="method-signature">
          <span class="method-name">encrypt_password</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000165-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000165-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 279</span>
279:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">encrypt_password</span>
280:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pwd</span>.<span class="ruby-identifier">blank?</span>
281:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">salt</span> = <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA1</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-node">&quot;--#{Time.now.to_s}--#{login}--&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_record?</span>
282:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">crypted_password</span> = <span class="ruby-identifier">encrypt</span>(<span class="ruby-identifier">pwd</span>)
283:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000167" class="method-detail">
        <a name="M000167"></a>

        <div class="method-heading">
          <a href="#M000167" class="method-signature">
          <span class="method-name">login_required?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000167-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000167-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 289</span>
289:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">login_required?</span>
290:       <span class="ruby-operator">!</span><span class="ruby-identifier">login_required</span>.<span class="ruby-identifier">blank?</span>
291:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000166" class="method-detail">
        <a name="M000166"></a>

        <div class="method-heading">
          <a href="#M000166" class="method-signature">
          <span class="method-name">password_required?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000166-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000166-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 285</span>
285:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">password_required?</span>
286:       <span class="ruby-identifier">crypted_password</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">pwd</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">password_required</span>
287:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000164" class="method-detail">
        <a name="M000164"></a>

        <div class="method-heading">
          <a href="#M000164" class="method-signature">
          <span class="method-name">set_email</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000164-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000164-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 275</span>
275:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_email</span>
276:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">email</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">login</span>
277:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000162" class="method-detail">
        <a name="M000162"></a>

        <div class="method-heading">
          <a href="#M000162" class="method-signature">
          <span class="method-name">validate</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validate uniqueness of login exept users that are canceled
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000162-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000162-source">
<pre>
     <span class="ruby-comment cmt"># File app/models/user.rb, line 258</span>
258:          <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate</span>
259:            <span class="ruby-identifier">user_using_login</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_login</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">login</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;status != ?&quot;</span>, <span class="ruby-constant">Status</span><span class="ruby-operator">::</span><span class="ruby-constant">CANCELED</span>])
260:            <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">user_using_login</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">user_using_login</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">self</span>
261:              <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">:login</span>, <span class="ruby-constant">ErrorMessages</span><span class="ruby-operator">::</span><span class="ruby-constant">Login</span><span class="ruby-operator">::</span><span class="ruby-constant">USED</span>
262:              <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
263:            <span class="ruby-keyword kw">end</span>
264:            <span class="ruby-keyword kw">true</span>
265:          <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>